import csv

def read_data(file_name):
    with open(file_name, 'r') as file:
        reader = csv.reader(file)
        data = list(reader)
    return data

def count_regions(data, regions):
    region_counts = {}
    for item in data:
        try:
            quantity = int(item[0])
            region_codes = item[1].split(',')
        except IndexError:
            print("Warning: skipping a row due to incorrect format")
            continue

        for code in region_codes:
            code = code.strip()
            region = regions.get(code)
            if region:
                region_counts[region] = region_counts.get(region, 0) + quantity
    return region_counts

def print_counts(region_counts):
    for region, count in region_counts.items():
        print(f'{count} машин - {region}')

def main():
    regions = {
        '01': 'Республика Адыгея',
        '02': 'Республика Башкортостан',
        '03': 'Республика Бурятия',
        '04': 'Республика Алтай',
        '05': 'Республика Дагестан',
        '06': 'Республика Ингушетия',
        '07': 'Кабардино-Балкарская Республика',
        '08': 'Республика Калмыкия',
        '09': 'Карачаево-Черкесская Республика',
        '10': 'Республика Карелия',
        '11': 'Республика Коми',
        '12': 'Республика Марий Эл',
        '13': 'Республика Мордовия',
        '14': 'Республика Саха-Якутия',
        '15': 'Республика Северная Осетия-Алания',
        '16': 'Республика Татарстан',
        '17': 'Республика Тыва',
        '18': 'Удмуртская Республика',
        '19': 'Республика Хакасия',
        '20': 'Республика Чечня',
        '21': 'Чувашская Республика — Чувашия',
        '22': 'Алтайский край',
        '23': 'Краснодарский край',
        '24': 'Красноярский край',
        '25': 'Приморский край',
        '26': 'Ставропольский край',
        '27': 'Хабаровский край',
        '28': 'Амурская область',
        '29': 'Архангельская область',
        '30': 'Астраханская область',
        '31': 'Белгородская область',
        '32': 'Брянская область',
        '33': 'Владимирская область',
        '34': 'Волгоградская область',
        '35': 'Вологодская область',
        '36': 'Воронежская область',
        '37': 'Ивановская область',
        '38': 'Иркутская область',
        '39': 'Калининградская область',
        '40': 'Калужская область',
        '41': 'Камчатская область',
        '42': 'Кемеровская область',
        '43': 'Кировская область',
        '44': 'Костромская область',
        '45': 'Курганская область',
        '46': 'Курская область',
        '47': 'Ленинградская область',
        '48': 'Липецкая область',
        '49': 'Магаданская область',
        '50': 'Московская область',
        '51': 'Мурманская область',
        '52': 'Нижегородская область',
        '53': 'Новгородская область',
        '54': 'Новосибирская область',
        '55': 'Омская область',
        '56': 'Оренбургская область',
        '57': 'Орловская область',
        '58': 'Пензенская область',
        '59': 'Пермский край',
        '60': 'Псковская область',
        '61': 'Ростовская область',
        '62': 'Рязанская область',
        '63': 'Самарская область',
        '64': 'Саратовская область',
        '65': 'Сахалинская область',
        '66': 'Свердловская область',
        '67': 'Смоленская область',
        '68': 'Тамбовская область',
        '69': 'Тверская область',
        '70': 'Томская область',
        '71': 'Тульская область',
        '72': 'Тюменская область',
        '73': 'Ульяновская область',
        '74': 'Челябинская область',
        '75': 'Читинская область',
        '76': 'Ярославская область',
        '77': 'Москва',
        '78': 'Санкт-Петербург',
        '79': 'Еврейская авт. область',
        '80': 'Агинский Бурятский авт. округ',
        '81': 'Коми-Пермяцкий авт. округ',
        '82': 'Корякский авт. округ',
        '83': 'Ненецкий авт. округ',
        '84': 'Таймырский авт. округ',
        '85': 'Усть-Ордынский Бурятский авт. округ',
        '86': 'Ханты-Мансийский авт. округ - Югра',
        '87': 'Чукотский авт. округ',
        '88': 'Эвенкийский авт. округ',
        '89': 'Ямало-Ненецкий авт. округ',
        '90': 'Московская область',
        '93': 'Краснодарский край',
        '95': 'Чеченская республика',
        '96': 'Свердловская область',
        '97': 'Московская область',
        '98': 'Санкт-Петербург',
        '99': 'Москва',
        '102': 'Республика Башкортостан',
        '116': 'Республика Татарстан',
        '118': 'Удмуртская Республика',
        '121': 'Чувашская Республика — Чувашия',
        '125': 'Приморский край',
        '138': 'Иркутская область',
        '154': 'Новосибирская область',
        '159': 'Пермский край',
        '161': 'Ростовская область',
        '163': 'Самарская область',
        '173': 'Ульяновская область',
        '174': 'Челябинская область',
        '177': 'Москва',
        '178': 'Санкт-Петербург',
        '186': 'Ханты-Мансийский автономный округ',
        '190': 'Московская область',
        '196': 'Свердловская область',
        '197': 'Москва',
        '199': 'Санкт-Петербург',
        '716': 'Республика Татарстан',
        '750': 'Московская область',
        '761': 'Нижегородская область',
        '763': 'Самарская область',
        '774': 'Челябинская область',
        '777': 'Москва',
        '799': 'Санкт-Петербург',
        '716': 'Республика Татарстан',
        '750': 'Московская область',
        '761': 'Нижегородская область',
        '763': 'Самарская область',
        '774': 'Челябинская область',
        '777': 'Москва'
    }

    data = read_data('output.csv')
    region_counts = count_regions(data, regions)
    print_counts(region_counts)

if __name__ == "__main__":
    main()
